---
title: "Data Analysis"
author: "Abhishek"
date: "12/9/2019"
output: html_document
---


For doing this analysis, I used three data sets from NHTS(National Household Travel Survey), the 2001, 2009 and 2017 datasets

And the data from these datasets used are :

HHFAMINC -  Household income

03 - $15,000 TO $24,999
07 - 	$75,000 to $99,999
09 - 	$125,000 to $149,999

HHVEHCNT - Count of Household vehicles


RAIL- MSA heavy rail status for household

WTHHFIN - Data needed to weight Household data

CNTTDHH - Count of household trips on travel day



```{r main1, echo=FALSE}

library(tidyverse)

year_2001 <- read_csv("2001/HHPUB.csv") %>%
  mutate(HOUSEID = as.factor(HOUSEID), Year = c(rep (2001, 69817))) %>%
  select(HHFAMINC, CNTTDHH, HHVEHCNT, Year, RAIL, WTHHFIN)

year_2009 <- read_csv("2009/HHPUB.csv")%>%
  mutate(HOUSEID = as.factor(HOUSEID), Year = c(rep (2009, 150147)))%>%
  select(HHFAMINC, CNTTDHH, HHVEHCNT, Year, RAIL, WTHHFIN)

year_2017 <- read_csv("2017/hhpub.csv")%>%
  mutate(HOUSEID = as.factor(HOUSEID), Year = c(rep (2017, 129696)))%>%
  select(HHFAMINC, CNTTDHH, HHVEHCNT, Year, RAIL, WTHHFIN)

```


Below, we can see that there are a lot of trips made by people in the medium incomde group, infact more than people in the higher and lower income groups.

``` {rmain2, echo=FALSE}
#COLUMN PLOTS OF TRIPS MADE BY THE THREE INCOME GROUPS CONSIDERED


year_2001 %>%
  filter(HHFAMINC %in% c("03","07","09"))%>%
  ggplot(aes(x = HHFAMINC, y = CNTTDHH, weight = WTHHFIN)) + geom_col(fill = "blue")

year_2009 %>%
  filter(HHFAMINC %in% c("03","07","09"))%>%
  ggplot(aes(x = HHFAMINC, y = CNTTDHH, weight = WTHHFIN)) + geom_col(fill = "blue")

year_2017 %>%
  filter(HHFAMINC %in% c("03","07","09"))%>%
  ggplot(aes(x = HHFAMINC, y = CNTTDHH, weight = WTHHFIN)) + geom_col(fill = "blue")
```


I have also displayed the car ownership data of the three income groups to show the density of car ownership and we can see from the data that there is more ownership of two cars in the income group 07. 

```{rmain3, echo=FALSE}

#VIOLIN PLOTS OF NO. OF CARS OWNED BY THE THREE INCOME GROUPS


violin_plot2001 = year_2001%>%
  filter(HHFAMINC %in% c("03","07","09"))%>%
  mutate(veh = ifelse(HHVEHCNT > 3, 4, HHVEHCNT))%>%
  ggplot(aes(x = factor(HHFAMINC), y = veh, weight = WTHHFIN, fill = HHFAMINC))+
  geom_violin(trim = FALSE)+scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))

violin_plot2001



violin_plot2009 = year_2009%>%
  filter(HHFAMINC %in% c("03","07","09"))%>%
  mutate(veh = ifelse(HHVEHCNT > 3, 4, HHVEHCNT))%>%
  ggplot(aes(x = factor(HHFAMINC), y = veh, weight = WTHHFIN, fill = HHFAMINC))+
  geom_violin(trim = FALSE)+scale_fill_brewer(palette="Dark2")

violin_plot2009



violin_plot2017 = year_2017%>%
  filter(HHFAMINC %in% c("03","07","09"))%>%
  mutate(veh = ifelse(HHVEHCNT > 3, 4, HHVEHCNT))%>%
  ggplot(aes(x = factor(HHFAMINC), y = veh, weight = WTHHFIN, fill = HHFAMINC))+
  geom_violin(trim = FALSE)+scale_fill_brewer(palette="Dark2")

violin_plot2017
###

```






